{{ $item := .item }}
{{ $link := $item.RelPermalink }}
{{ $target := "" }}
{{ if $item.Params.external_link }}
  {{ $link = $item.Params.external_link }}
  {{ $target = "target=\"_blank\" rel=\"noopener\"" }}
{{ end }}

<li style="margin-bottom:1.2em; line-height:1.6;">
  {{ with $item.Params.authors }}
    {{ $authorList := slice }} {{/* 저자 이름을 저장할 슬라이스 생성 */}}
    {{ range $idx, $author := . }}
      {{ $authorDisplay := $author }}
      {{ $isCorresponding := false }}

      {{/* author_notes 필드에서 교신저자 여부 확인 */}}
      {{ if $item.Params.author_notes }}
        {{ if lt $idx (len $item.Params.author_notes) }}
          {{ if eq (index $item.Params.author_notes $idx) "Corresponding author" }}
            {{ $isCorresponding = true }}
          {{ end }}
        {{ end }}
      {{ end }}

      {{ $authorOutput := "" }}
      {{/* urlize를 한국어 이름에도 적용하는 것이 불안정할 수 있으므로, 해당 저자 페이지가 확실히 영어 이름으로 된 폴더명이라면 urlize를 쓰되, 아니면 $authorDisplay를 그대로 사용하거나 명확한 폴더명을 지정해야 함 */}}
      {{/* 여기서는 urlize를 적용하여 Hugo의 기본 동작을 따르되, 만약 링크가 깨지면 해당 부분을 수동 조정해야 합니다. */}}
      {{ $authorPage := site.GetPage (printf "authors/%s" (urlize $authorDisplay)) }}
      {{ if $authorPage }}
        {{ $authorOutput = printf "<a href=\"%s\" style=\"color: black;\">%s</a>" $authorPage.RelPermalink $authorDisplay | safeHTML }}
      {{ else }}
        {{ $authorOutput = $authorDisplay }}
      {{ end }}

      {{ if $isCorresponding }}
        {{ $authorOutput = printf "%s<span style=\"vertical-align: super;\">*</span>" $authorOutput | safeHTML }}
      {{ end }}

      {{ $authorList = $authorList | append $authorOutput }}
    {{ end }}

    {{/* delimit를 사용하여 저자 목록을 올바르게 결합 */}}
    {{ $lastAuthor := "" }}
    {{ if gt (len $authorList) 1 }}
      {{ $lastAuthor = index $authorList (sub (len $authorList) 1) }}
      {{ $authorList = after (sub (len $authorList) 1) $authorList }}
      {{ if gt (len $authorList) 0 }}
        {{ delimit $authorList ", " }} and {{ $lastAuthor }}.
      {{ else }}
        {{ $lastAuthor }}.
      {{ end }}
    {{ else if eq (len $authorList) 1 }}
      {{ index $authorList 0 }}.
    {{ end }}
  {{ end }}
  "<b>
    {{ if $link }}
      <a href="{{$link}}" {{ $target | safeHTMLAttr }} style="color: black;">{{ $item.Title }}</a>
    {{ else }}
      {{ $item.Title }}
    {{ end }}
  </b>,"
  {{ with $item.Params.publication }}
    <i>{{ . }}</i>,
  {{ end }}
  {{ with $item.Params.date }}
    {{ if $item.Params.volume }}
      vol. {{ $item.Params.volume }},
    {{ end }}
    {{ if $item.Params.issue }}
      no. {{ $item.Params.issue }},
    {{ end }}
    {{ if $item.Params.pages }}
      pp. {{ $item.Params.pages }},
    {{ end }}
    {{ (time .).Format "Jan." }} {{ (time .).Year }}.
  {{ end }}
  {{ if $item.Params.url_pdf }}
    <a href="{{ $item.Params.url_pdf }}" target="_blank" style="color: black;">[PDF]</a>
  {{ end }}
</li>